var audio_bass=false,audio_reverberation=false;var AudioContext=AudioContext||webkitAudioContext;var context=new AudioContext;var source=context.createMediaElementSource(audio);var convolver=context.createConvolver();var convolver2=context.createConvolver();var delay=context.createDelay();var gain=context.createGain();var gain2=context.createGain();var gain3=context.createGain();var gain4=context.createGain();var filter=context.createBiquadFilter();var distortion=context.createWaveShaper();gain.gain.value=1;gain2.gain.value=0.7;gain3.gain.value=0.25;gain4.gain.value=1;source.connect(gain);source.connect(convolver);source.connect(convolver2);convolver.connect(gain2);convolver2.connect(gain3);gain.connect(context.destination);source.connect(gain4);filter.type='lowpass';filter.frequency.value=100;var frameCount=context.sampleRate*2.0;var length=context.sampleRate;var buffer=context.createBuffer(2,frameCount,context.sampleRate);var data=[buffer.getChannelData(0),buffer.getChannelData(1)];for(var i=0;i<length;i++){var v=1-Math.sqrt(i/length);for(var j=1;j<=24;j++){v*=Math.sin(i/j)}data[0][i]=data[1][i]=v};function makeDistortionCurve(amount){var k=typeof amount==='number'?amount:50,n_samples=context.sampleRate,curve=new Float32Array(n_samples),deg=Math.PI/180,i=0,x;for(;i<n_samples;++i){x=i*2/n_samples-1;curve[i]=(3+k)*x*20*deg/(Math.PI+k*Math.abs(x))}return curve};distortion.curve=makeDistortionCurve(20);distortion.oversample='none';convolver.buffer=buffer;convolver2.buffer=buffer;function bass_effect(option){audio_bass=option;if(audio_bass==false){filter.disconnect();if(audio_reverberation==false){gain.gain.value=1}else{gain.gain.value=0.4}}else{gain4.connect(filter);filter.connect(context.destination);gain.gain.value=0.4}}function rever_effect(option){audio_reverberation=option;if(audio_reverberation==false){convolver.disconnect();convolver2.disconnect();if(audio_reverberation==false){gain.gain.value=1}else{gain.gain.value=0.4}}else{convolver.connect(context.destination);convolver2.connect(context.destination);gain.gain.value=0.4}}function bass_volume(option){option=option/100;gain4.gain.value=option}